<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:SkyDrop.ViewModels"
             xmlns:controls="using:SkyDrop.Controls"
             xmlns:res="clr-namespace:SkyDrop.Resources"
             mc:Ignorable="d" d:DesignWidth="700" d:DesignHeight="600"
             x:Class="SkyDrop.Views.CreatePostGameView"
             x:DataType="vm:CreatePostGameViewModel"
             Focusable="True">

    <Panel>
        <Grid ColumnDefinitions="*,280" IsVisible="{Binding !IsGameOver}">
            <Border Grid.Column="0"
                    BorderBrush="{DynamicResource BorderBrush}"
                    BorderThickness="2"
                    CornerRadius="4"
                    Margin="20">
                <controls:GameCanvas Engine="{Binding Engine}"
                                     ShowGhost="True"
                                     ShowGrid="True"/>
            </Border>

            <Border Grid.Column="1"
                    Background="{DynamicResource PanelBackgroundBrush}"
                    Padding="15"
                    Margin="0,20,20,20"
                    CornerRadius="4">
                <Grid RowDefinitions="Auto,Auto,Auto,Auto,*,Auto">
                    <Grid Grid.Row="0" ColumnDefinitions="*,*,*, Auto" Margin="0,0,0,15">
                        <StackPanel Grid.Column="0" HorizontalAlignment="Center">
                            <TextBlock Text="{x:Static res:Strings.Score}" FontSize="10" FontWeight="SemiBold" Foreground="{DynamicResource SecondaryTextBrush}" HorizontalAlignment="Center"/>
                            <TextBlock Text="{Binding Score}" FontSize="16" FontWeight="Bold" Foreground="{DynamicResource AccentGoldBrush}" HorizontalAlignment="Center"/>
                        </StackPanel>
                        <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                            <TextBlock Text="{x:Static res:Strings.Level}" FontSize="10" FontWeight="SemiBold" Foreground="{DynamicResource SecondaryTextBrush}" HorizontalAlignment="Center"/>
                            <TextBlock Text="{Binding Level}" FontSize="16" FontWeight="Bold" Foreground="{DynamicResource AccentCyanBrush}" HorizontalAlignment="Center"/>
                        </StackPanel>
                        <StackPanel Grid.Column="2" HorizontalAlignment="Center">
                            <TextBlock Text="{x:Static res:Strings.Lines}" FontSize="10" FontWeight="SemiBold" Foreground="{DynamicResource SecondaryTextBrush}" HorizontalAlignment="Center"/>
                            <TextBlock Text="{Binding Lines}" FontSize="16" FontWeight="Bold" Foreground="{DynamicResource AccentGreenBrush}" HorizontalAlignment="Center"/>
                        </StackPanel>
                        <StackPanel Grid.Column="3" HorizontalAlignment="Center" Margin="8,0,0,0">
                            <TextBlock Text="{x:Static res:Strings.Next}" FontSize="10" FontWeight="SemiBold" Foreground="{DynamicResource SecondaryTextBrush}" HorizontalAlignment="Center"/>
                            <Border Background="{DynamicResource NextPieceBackgroundBrush}" CornerRadius="4" Width="50" Height="40">
                                <controls:NextPieceCanvas Piece="{Binding NextPiece}"/>
                            </Border>
                        </StackPanel>
                    </Grid>

                    <!-- Standard Mode Content -->
                    <StackPanel Grid.Row="1" Margin="0,0,0,15" IsVisible="{Binding IsStandardMode}">
                        <Grid ColumnDefinitions="*,Auto" Margin="0,0,0,8">
                            <TextBlock Grid.Column="0" Text="{x:Static res:Strings.SelectedKey}" FontSize="10" FontWeight="SemiBold" Foreground="{DynamicResource SecondaryTextBrush}" HorizontalAlignment="Center"/>
                            <Border Grid.Column="1" Background="{DynamicResource AccentCyanBrush}" CornerRadius="3" Padding="6,2">
                                <TextBlock Text="{Binding InputModeDisplay}" FontSize="10" FontWeight="Bold" Foreground="White"/>
                            </Border>
                        </Grid>

                        <Border Background="{DynamicResource NextPieceBackgroundBrush}"
                                CornerRadius="4"
                                Padding="8"
                                Margin="0,0,0,8"
                                IsVisible="{Binding IsAbcMode}">
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                <TextBlock Text="{x:Static res:Strings.CharLabel}" FontSize="12" Foreground="{DynamicResource SecondaryTextBrush}" VerticalAlignment="Center" Margin="0,0,4,0"/>
                                <TextBlock Text="{Binding CurrentAbcCharacter}" FontSize="24" FontWeight="Bold" Foreground="{DynamicResource AccentGoldBrush}" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Border>

                        <Border Background="{DynamicResource NextPieceBackgroundBrush}"
                                CornerRadius="4"
                                Padding="8"
                                Margin="0,0,0,8"
                                IsVisible="{Binding IsKanaMode}">
                            <StackPanel HorizontalAlignment="Center" Spacing="4">
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <TextBlock Text="{x:Static res:Strings.KanaLabel}" FontSize="12" Foreground="{DynamicResource SecondaryTextBrush}" VerticalAlignment="Center" Margin="0,0,4,0"/>
                                    <TextBlock Text="{Binding CurrentKanaCharacter}" FontSize="24" FontWeight="Bold" Foreground="{DynamicResource AccentGoldBrush}" VerticalAlignment="Center"/>
                                </StackPanel>
                                <Border Background="{DynamicResource GameBackgroundBrush}"
                                        CornerRadius="3"
                                        Padding="6,3"
                                        IsVisible="{Binding CurrentKanaInput, Converter={x:Static StringConverters.IsNotNullOrEmpty}}">
                                    <TextBlock Text="{Binding CurrentKanaInput}"
                                               FontSize="14"
                                               Foreground="{DynamicResource AccentCyanBrush}"
                                               HorizontalAlignment="Center"/>
                                </Border>
                                <Border Background="{DynamicResource AccentGreenBrush}"
                                        CornerRadius="3"
                                        Padding="8,4"
                                        IsVisible="{Binding HasKanjiSuggestions}">
                                    <TextBlock Text="{Binding CurrentSuggestionDisplay}"
                                               FontSize="16"
                                               FontWeight="Bold"
                                               Foreground="White"
                                               HorizontalAlignment="Center"/>
                                </Border>
                            </StackPanel>
                        </Border>

                        <Grid ColumnDefinitions="*,*,*" RowDefinitions="Auto,Auto,Auto,Auto,Auto" HorizontalAlignment="Center">
                            <Border Grid.Row="0" Grid.Column="0" x:Name="Key1" Background="{DynamicResource ButtonBackgroundBrush}" BorderBrush="Transparent" BorderThickness="2" CornerRadius="4" Padding="12,8" Margin="2">
                                <TextBlock Text="1" FontSize="16" FontWeight="Bold" HorizontalAlignment="Center" Foreground="{DynamicResource PrimaryTextBrush}"/>
                            </Border>
                            <Border Grid.Row="0" Grid.Column="1" x:Name="Key2" Background="{DynamicResource ButtonBackgroundBrush}" BorderBrush="Transparent" BorderThickness="2" CornerRadius="4" Padding="12,8" Margin="2">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="2" FontSize="16" FontWeight="Bold" HorizontalAlignment="Center" Foreground="{DynamicResource PrimaryTextBrush}"/>
                                    <TextBlock Text="ABC" FontSize="8" HorizontalAlignment="Center" Foreground="{DynamicResource TertiaryTextBrush}"/>
                                </StackPanel>
                            </Border>
                            <Border Grid.Row="0" Grid.Column="2" x:Name="Key3" Background="{DynamicResource ButtonBackgroundBrush}" BorderBrush="Transparent" BorderThickness="2" CornerRadius="4" Padding="12,8" Margin="2">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="3" FontSize="16" FontWeight="Bold" HorizontalAlignment="Center" Foreground="{DynamicResource PrimaryTextBrush}"/>
                                    <TextBlock Text="DEF" FontSize="8" HorizontalAlignment="Center" Foreground="{DynamicResource TertiaryTextBrush}"/>
                                </StackPanel>
                            </Border>

                            <Border Grid.Row="1" Grid.Column="0" x:Name="Key4" Background="{DynamicResource ButtonBackgroundBrush}" BorderBrush="Transparent" BorderThickness="2" CornerRadius="4" Padding="12,8" Margin="2">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="4" FontSize="16" FontWeight="Bold" HorizontalAlignment="Center" Foreground="{DynamicResource PrimaryTextBrush}"/>
                                    <TextBlock Text="GHI" FontSize="8" HorizontalAlignment="Center" Foreground="{DynamicResource TertiaryTextBrush}"/>
                                </StackPanel>
                            </Border>
                            <Border Grid.Row="1" Grid.Column="1" x:Name="Key5" Background="{DynamicResource ButtonBackgroundBrush}" BorderBrush="Transparent" BorderThickness="2" CornerRadius="4" Padding="12,8" Margin="2">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="5" FontSize="16" FontWeight="Bold" HorizontalAlignment="Center" Foreground="{DynamicResource PrimaryTextBrush}"/>
                                    <TextBlock Text="JKL" FontSize="8" HorizontalAlignment="Center" Foreground="{DynamicResource TertiaryTextBrush}"/>
                                </StackPanel>
                            </Border>
                            <Border Grid.Row="1" Grid.Column="2" x:Name="Key6" Background="{DynamicResource ButtonBackgroundBrush}" BorderBrush="Transparent" BorderThickness="2" CornerRadius="4" Padding="12,8" Margin="2">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="6" FontSize="16" FontWeight="Bold" HorizontalAlignment="Center" Foreground="{DynamicResource PrimaryTextBrush}"/>
                                    <TextBlock Text="MNO" FontSize="8" HorizontalAlignment="Center" Foreground="{DynamicResource TertiaryTextBrush}"/>
                                </StackPanel>
                            </Border>

                            <Border Grid.Row="2" Grid.Column="0" x:Name="Key7" Background="{DynamicResource ButtonBackgroundBrush}" BorderBrush="Transparent" BorderThickness="2" CornerRadius="4" Padding="12,8" Margin="2">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="7" FontSize="16" FontWeight="Bold" HorizontalAlignment="Center" Foreground="{DynamicResource PrimaryTextBrush}"/>
                                    <TextBlock Text="PQRS" FontSize="8" HorizontalAlignment="Center" Foreground="{DynamicResource TertiaryTextBrush}"/>
                                </StackPanel>
                            </Border>
                            <Border Grid.Row="2" Grid.Column="1" x:Name="Key8" Background="{DynamicResource ButtonBackgroundBrush}" BorderBrush="Transparent" BorderThickness="2" CornerRadius="4" Padding="12,8" Margin="2">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="8" FontSize="16" FontWeight="Bold" HorizontalAlignment="Center" Foreground="{DynamicResource PrimaryTextBrush}"/>
                                    <TextBlock Text="TUV" FontSize="8" HorizontalAlignment="Center" Foreground="{DynamicResource TertiaryTextBrush}"/>
                                </StackPanel>
                            </Border>
                            <Border Grid.Row="2" Grid.Column="2" x:Name="Key9" Background="{DynamicResource ButtonBackgroundBrush}" BorderBrush="Transparent" BorderThickness="2" CornerRadius="4" Padding="12,8" Margin="2">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="9" FontSize="16" FontWeight="Bold" HorizontalAlignment="Center" Foreground="{DynamicResource PrimaryTextBrush}"/>
                                    <TextBlock Text="WXYZ" FontSize="8" HorizontalAlignment="Center" Foreground="{DynamicResource TertiaryTextBrush}"/>
                                </StackPanel>
                            </Border>

                            <Border Grid.Row="3" Grid.Column="0" x:Name="KeyStar" Background="{DynamicResource ButtonBackgroundBrush}" BorderBrush="Transparent" BorderThickness="2" CornerRadius="4" Padding="12,8" Margin="2">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="*" FontSize="16" FontWeight="Bold" HorizontalAlignment="Center" Foreground="{DynamicResource AccentRedBrush}"/>
                                    <TextBlock Text="DEL" FontSize="8" HorizontalAlignment="Center" Foreground="{DynamicResource TertiaryTextBrush}"/>
                                </StackPanel>
                            </Border>
                            <Border Grid.Row="3" Grid.Column="1" x:Name="Key0" Background="{DynamicResource ButtonBackgroundBrush}" BorderBrush="Transparent" BorderThickness="2" CornerRadius="4" Padding="12,8" Margin="2">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="0" FontSize="16" FontWeight="Bold" HorizontalAlignment="Center" Foreground="{DynamicResource PrimaryTextBrush}"/>
                                    <TextBlock Text="SPC" FontSize="8" HorizontalAlignment="Center" Foreground="{DynamicResource TertiaryTextBrush}"/>
                                </StackPanel>
                            </Border>
                            <Border Grid.Row="3" Grid.Column="2" x:Name="KeyPound" Background="{DynamicResource ButtonBackgroundBrush}" BorderBrush="Transparent" BorderThickness="2" CornerRadius="4" Padding="12,8" Margin="2">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="#" FontSize="16" FontWeight="Bold" HorizontalAlignment="Center" Foreground="{DynamicResource AccentGreenBrush}"/>
                                    <TextBlock Text="OK" FontSize="8" HorizontalAlignment="Center" Foreground="{DynamicResource TertiaryTextBrush}"/>
                                </StackPanel>
                            </Border>

                            <Border Grid.Row="4" Grid.Column="0" Grid.ColumnSpan="3"
                                    x:Name="KeyOK"
                                    Background="{DynamicResource ButtonBackgroundBrush}"
                                    BorderBrush="Transparent"
                                    BorderThickness="2"
                                    CornerRadius="4"
                                    Padding="12,8"
                                    Margin="2"
                                    IsVisible="{Binding IsKanaMode}">
                                <TextBlock Text="OK" FontSize="16" FontWeight="Bold" HorizontalAlignment="Center" Foreground="{DynamicResource AccentGreenBrush}"/>
                            </Border>
                        </Grid>
                    </StackPanel>

                    <StackPanel Grid.Row="2" Margin="0,0,0,10" IsVisible="{Binding IsStandardMode}">
                        <Grid ColumnDefinitions="*,Auto">
                            <TextBlock Grid.Column="0" Text="{x:Static res:Strings.Word}" FontSize="10" FontWeight="SemiBold" Foreground="{DynamicResource SecondaryTextBrush}"/>
                            <TextBlock Grid.Column="1" Text="{Binding CurrentT9Sequence}" FontSize="10" FontWeight="SemiBold" Foreground="{DynamicResource AccentGoldBrush}" FontFamily="Consolas,Monaco,monospace"/>
                        </Grid>
                        <Border Background="{DynamicResource NextPieceBackgroundBrush}" CornerRadius="4" Padding="8" MinHeight="30">
                            <TextBlock Text="{Binding CurrentWordPreview}"
                                       FontSize="18"
                                       FontWeight="Bold"
                                       Foreground="{DynamicResource AccentCyanBrush}"
                                       TextWrapping="Wrap"/>
                        </Border>
                    </StackPanel>

                    <StackPanel Grid.Row="3" Margin="0,0,0,10" IsVisible="{Binding IsStandardMode}">
                        <Grid ColumnDefinitions="*,Auto">
                            <TextBlock Grid.Column="0" Text="{x:Static res:Strings.CurrentPost}" FontSize="10" FontWeight="SemiBold" Foreground="{DynamicResource SecondaryTextBrush}"/>
                            <TextBlock Grid.Column="1" FontSize="10" FontWeight="SemiBold" HorizontalAlignment="Right">
                                <TextBlock.Text>
                                    <MultiBinding StringFormat="{}{0}/300">
                                        <Binding Path="CurrentPostLength"/>
                                    </MultiBinding>
                                </TextBlock.Text>
                                <TextBlock.Foreground>
                                    <MultiBinding>
                                        <MultiBinding.Converter>
                                            <x:Null/>
                                        </MultiBinding.Converter>
                                    </MultiBinding>
                                </TextBlock.Foreground>
                            </TextBlock>
                        </Grid>
                        <Border Background="{DynamicResource NextPieceBackgroundBrush}" CornerRadius="4" Padding="8" MinHeight="40">
                            <TextBlock Text="{Binding CurrentPost}"
                                       FontSize="11"
                                       Foreground="{DynamicResource PrimaryTextBrush}"
                                       TextWrapping="Wrap"/>
                        </Border>
                        <TextBlock Text="{x:Static res:Strings.PostTooLong}"
                                   FontSize="10"
                                   Foreground="{DynamicResource AccentRedBrush}"
                                   IsVisible="{Binding IsPostTooLong}"
                                   Margin="0,4,0,0"/>
                    </StackPanel>

                    <!-- Queued Mode Content -->
                    <StackPanel Grid.Row="1" Grid.RowSpan="3" Margin="0,0,0,15" IsVisible="{Binding IsQueuedMode}">
                        <!-- Progress Header -->
                        <Border Background="{DynamicResource AccentPurpleBrush}" CornerRadius="4" Padding="8" Margin="0,0,0,10">
                            <StackPanel HorizontalAlignment="Center">
                                <TextBlock Text="{x:Static res:Strings.QueuedModeLabel}"
                                           FontSize="12"
                                           FontWeight="Bold"
                                           Foreground="White"
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Border>

                        <!-- Progress Display -->
                        <StackPanel Spacing="8">
                            <Grid ColumnDefinitions="*,Auto">
                                <TextBlock Grid.Column="0" Text="{x:Static res:Strings.WordsRevealed}" FontSize="10" FontWeight="SemiBold" Foreground="{DynamicResource SecondaryTextBrush}"/>
                                <TextBlock Grid.Column="1" FontSize="10" FontWeight="Bold">
                                    <TextBlock.Text>
                                        <MultiBinding StringFormat="{}{0}/{1}">
                                            <Binding Path="WordsRevealed"/>
                                            <Binding Path="TotalWords"/>
                                        </MultiBinding>
                                    </TextBlock.Text>
                                    <TextBlock.Foreground>
                                        <Binding Path="IsQueueComplete">
                                            <Binding.Converter>
                                                <x:Null/>
                                            </Binding.Converter>
                                        </Binding>
                                    </TextBlock.Foreground>
                                </TextBlock>
                            </Grid>

                            <!-- Progress Bar -->
                            <Grid Height="20">
                                <ProgressBar Minimum="0"
                                             Maximum="100"
                                             Value="{Binding QueuedProgressPercent}"
                                             Background="{DynamicResource NextPieceBackgroundBrush}"
                                             Foreground="{DynamicResource AccentGreenBrush}"
                                             CornerRadius="4"/>
                                <TextBlock Text="{Binding QueuedProgressPercent, StringFormat={}{0}%}"
                                           FontSize="10"
                                           FontWeight="Bold"
                                           Foreground="{DynamicResource PrimaryTextBrush}"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"/>
                            </Grid>

                            <!-- Completion Badge -->
                            <Border Background="{DynamicResource AccentGreenBrush}"
                                    CornerRadius="4"
                                    Padding="8,4"
                                    IsVisible="{Binding IsQueueComplete}"
                                    HorizontalAlignment="Center">
                                <TextBlock Text="{x:Static res:Strings.ThreadComplete}"
                                           FontSize="12"
                                           FontWeight="Bold"
                                           Foreground="White"/>
                            </Border>
                        </StackPanel>

                        <!-- Current Output Preview -->
                        <StackPanel Margin="0,15,0,0">
                            <TextBlock Text="{x:Static res:Strings.CurrentOutput}" FontSize="10" FontWeight="SemiBold" Foreground="{DynamicResource SecondaryTextBrush}" Margin="0,0,0,4"/>
                            <Border Background="{DynamicResource NextPieceBackgroundBrush}" CornerRadius="4" Padding="8" MinHeight="60">
                                <TextBlock Text="{Binding CurrentQueuedPostPreview}"
                                           FontSize="11"
                                           Foreground="{DynamicResource PrimaryTextBrush}"
                                           TextWrapping="Wrap"/>
                            </Border>
                        </StackPanel>

                        <!-- Instructions -->
                        <StackPanel Margin="0,15,0,0" Spacing="2">
                            <TextBlock Text="{x:Static res:Strings.QueuedInstructions}"
                                       FontSize="9"
                                       Foreground="{DynamicResource TertiaryTextBrush}"
                                       TextWrapping="Wrap"/>
                        </StackPanel>
                    </StackPanel>

                    <Grid Grid.Row="4" RowDefinitions="Auto,*" Margin="0,0,0,10">
                        <Grid Grid.Row="0" ColumnDefinitions="*,Auto" Margin="0,0,0,4">
                            <TextBlock Grid.Column="0" Text="{x:Static res:Strings.Completed}" FontSize="10" FontWeight="SemiBold" Foreground="{DynamicResource SecondaryTextBrush}"/>
                            <TextBlock Grid.Column="1" Text="{Binding CompletedPosts.Count}" FontSize="10" FontWeight="SemiBold" Foreground="{DynamicResource AccentGreenBrush}"/>
                        </Grid>
                        <Border Grid.Row="1" Background="{DynamicResource NextPieceBackgroundBrush}" CornerRadius="4" Padding="4">
                            <Panel>
                                <ScrollViewer x:Name="CompletedPostsScroller" VerticalScrollBarVisibility="Auto">
                                    <ItemsControl ItemsSource="{Binding CompletedPosts}">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Border Background="{DynamicResource GameBackgroundBrush}"
                                                        CornerRadius="3"
                                                        Padding="6,4"
                                                        Margin="0,0,0,4">
                                                    <TextBlock Text="{Binding}"
                                                               FontSize="10"
                                                               Foreground="{DynamicResource PrimaryTextBrush}"
                                                               TextWrapping="Wrap"
                                                               MaxLines="3"
                                                               TextTrimming="CharacterEllipsis"/>
                                                </Border>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </ScrollViewer>
                                <TextBlock Text="{x:Static res:Strings.PressHashToAddPost}"
                                           FontSize="9"
                                           Foreground="{DynamicResource TertiaryTextBrush}"
                                           IsVisible="{Binding !CompletedPosts.Count}"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"/>
                            </Panel>
                        </Border>
                    </Grid>

                    <StackPanel Grid.Row="5" Spacing="2">
                        <TextBlock Text="{x:Static res:Strings.Controls}" FontSize="10" FontWeight="SemiBold" Foreground="{DynamicResource TertiaryTextBrush}"/>
                        <TextBlock Text="{x:Static res:Strings.ControlRotateSelectKey}" FontSize="9" Foreground="{DynamicResource MutedTextBrush}"/>
                        <TextBlock Text="{x:Static res:Strings.ControlDropPressKey}" FontSize="9" Foreground="{DynamicResource MutedTextBrush}"/>
                        <TextBlock Text="{x:Static res:Strings.ControlTabCycleSuggestions}" FontSize="9" Foreground="{DynamicResource MutedTextBrush}"/>
                        <TextBlock Text="{x:Static res:Strings.ControlMToggleMode}" FontSize="9" Foreground="{DynamicResource AccentCyanBrush}"/>
                        <TextBlock Text="{x:Static res:Strings.ControlSpecialKeysShort}" FontSize="9" Foreground="{DynamicResource AccentGoldBrush}"/>
                        <TextBlock Text="{x:Static res:Strings.ControlEscPause}" FontSize="9" Foreground="{DynamicResource MutedTextBrush}"/>
                    </StackPanel>
                </Grid>
            </Border>
        </Grid>

        <Grid IsVisible="{Binding IsGameOver}" Background="{DynamicResource GameBackgroundBrush}">
            <Border Background="{DynamicResource PanelBackgroundBrush}"
                    CornerRadius="8"
                    Padding="30"
                    Margin="40"
                    VerticalAlignment="Stretch">
                <Grid RowDefinitions="Auto,*,Auto">
                    <StackPanel Grid.Row="0" HorizontalAlignment="Center" Margin="0,0,0,20">
                        <TextBlock Text="{x:Static res:Strings.GameOver}"
                                   FontSize="28"
                                   FontWeight="Bold"
                                   Foreground="{DynamicResource AccentRedBrush}"
                                   HorizontalAlignment="Center"/>
                        <TextBlock FontSize="16" Foreground="{DynamicResource SecondaryTextBrush}" HorizontalAlignment="Center" Margin="0,8,0,0">
                            <TextBlock.Text>
                                <MultiBinding StringFormat="Score: {0} | Level: {1} | Lines: {2}">
                                    <Binding Path="Score"/>
                                    <Binding Path="Level"/>
                                    <Binding Path="Lines"/>
                                </MultiBinding>
                            </TextBlock.Text>
                        </TextBlock>
                    </StackPanel>

                    <Grid Grid.Row="1" Margin="0,0,0,20">
                        <Border Background="{DynamicResource GameBackgroundBrush}" CornerRadius="4" Padding="15">
                            <StackPanel>
                                <TextBlock Text="{x:Static res:Strings.YourPosts}" FontSize="14" FontWeight="SemiBold" Foreground="{DynamicResource AccentCyanBrush}" Margin="0,0,0,10"/>
                                <ScrollViewer MaxHeight="250">
                                    <ItemsControl ItemsSource="{Binding CompletedPosts}">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Border Background="{DynamicResource NextPieceBackgroundBrush}"
                                                        CornerRadius="4"
                                                        Padding="10"
                                                        Margin="0,0,0,8">
                                                    <TextBlock Text="{Binding}"
                                                               FontSize="12"
                                                               Foreground="{DynamicResource PrimaryTextBrush}"
                                                               TextWrapping="Wrap"/>
                                                </Border>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </ScrollViewer>
                                <TextBlock Text="{x:Static res:Strings.NoPostsCreated}"
                                           FontSize="12"
                                           Foreground="{DynamicResource TertiaryTextBrush}"
                                           IsVisible="{Binding !CompletedPosts.Count}"
                                           HorizontalAlignment="Center"
                                           Margin="0,20,0,0"/>

                                <Border x:Name="ToggleOption"
                                        CornerRadius="4"
                                        Padding="10"
                                        Margin="0,15,0,0"
                                        BorderThickness="2"
                                        Background="{DynamicResource NextPieceBackgroundBrush}"
                                        BorderBrush="Transparent"
                                        IsVisible="{Binding CompletedPosts.Count}">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <StackPanel Grid.Column="0" Spacing="2">
                                            <TextBlock FontSize="12"
                                                       FontWeight="SemiBold"
                                                       Foreground="{DynamicResource PrimaryTextBrush}"
                                                       Text="{x:Static res:Strings.IncludeSkyDropSignature}"/>
                                            <TextBlock Text="{x:Static res:Strings.SignatureDescription}"
                                                       FontSize="10"
                                                       Foreground="{DynamicResource TertiaryTextBrush}"/>
                                        </StackPanel>
                                        <ToggleSwitch Grid.Column="1"
                                                      IsChecked="{Binding IncludeSkyDropSignature}"
                                                      OnContent=""
                                                      OffContent=""
                                                      VerticalAlignment="Center"/>
                                    </Grid>
                                </Border>

                                <Border x:Name="PostOption"
                                        CornerRadius="4"
                                        Padding="15,10"
                                        Margin="0,10,0,0"
                                        BorderThickness="2"
                                        Background="{DynamicResource AccentGreenBrush}"
                                        BorderBrush="Transparent"
                                        IsVisible="{Binding CompletedPosts.Count}"
                                        IsEnabled="{Binding CanPost}"
                                        Cursor="Hand">
                                    <Border.Styles>
                                        <Style Selector="Border:disabled">
                                            <Setter Property="Background" Value="{DynamicResource ButtonBackgroundBrush}"/>
                                            <Setter Property="Opacity" Value="0.6"/>
                                            <Setter Property="Cursor" Value="Arrow"/>
                                        </Style>
                                    </Border.Styles>
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Spacing="8">
                                        <TextBlock Text="{x:Static res:Strings.PostAsThread}" Foreground="White" FontWeight="Bold"/>
                                    </StackPanel>
                                </Border>

                                <TextBlock Text="{Binding PostingStatus}"
                                           FontSize="11"
                                           Foreground="{DynamicResource SecondaryTextBrush}"
                                           TextWrapping="Wrap"
                                           Margin="0,10,0,0"
                                           IsVisible="{Binding PostingStatus, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                            </StackPanel>
                        </Border>
                    </Grid>

                    <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center" Spacing="15">
                        <Border x:Name="RestartButton"
                                Background="{DynamicResource AccentCyanBrush}"
                                BorderBrush="Transparent"
                                BorderThickness="2"
                                CornerRadius="4"
                                Padding="30,12"
                                Cursor="Hand">
                            <TextBlock Text="{x:Static res:Strings.PlayAgain}"
                                       FontSize="14"
                                       FontWeight="Bold"
                                       Foreground="White"
                                       HorizontalAlignment="Center"/>
                        </Border>
                        <Border x:Name="TitleButton"
                                Background="{DynamicResource ButtonBackgroundBrush}"
                                BorderBrush="Transparent"
                                BorderThickness="2"
                                CornerRadius="4"
                                Padding="30,12"
                                Cursor="Hand">
                            <TextBlock Text="{x:Static res:Strings.Title}"
                                       FontSize="14"
                                       Foreground="{DynamicResource SecondaryTextBrush}"
                                       HorizontalAlignment="Center"/>
                        </Border>
                    </StackPanel>
                </Grid>
            </Border>
        </Grid>

        <controls:PauseOverlay x:Name="PauseOverlay" IsPaused="{Binding IsPaused}"/>

        <controls:InstructionsOverlay x:Name="InstructionsOverlay"
                                      IsVisibleOverlay="{Binding ShowInstructions}"
                                      />
    </Panel>
</UserControl>
